# Warmonger project: crawler module.

*Доброго времени суток, всем кто это читает. Вашему вниманию представляется распределенная автоматизированная система сбора и обработки информации под названием "**Warmonger" (пер. англ. Милитарист, в отношении наших Западных оппонентов.)
Ветка crawler-module посвящена обработке вебсайтов с БПЛА и их комплектующими.***

# Требования к эксплуатации

1) PostgreSQL => 14.0
2) Python => 3.10.0
3) Библиотеки из requirements.txt (для работы парсера и fastAPI)
4) Широкополосное подключение к ИТКС "Интернет"

# Установка

#### Подключение к БД

создайте файл DB.env в корне проекта, напишите в нем данные для подключения к БД PostgreSQL

`PORT = port `

`USER = user `

`PASSWORD = password `

`HOST = localhost \ ip `

`NAME = name`

#### Виртуальное окружение

Откройте терминал в корне проекта, выполните команды:

`python -m venv venv`

`venv\Scripts\activate`

`pip install -r requirements.txt`

# Запуск приложения

Вы создали виртуальное окружение и загрузили необходимые библиотеки, теперь можно запустить backend-часть и scrapy-частт проекта

#### Настройка отношений в БД

Для работы парсеров и fastAPI необходимо создать отношения из файла databaseConfig.py

Выполните в терминале:

`python databaseConfig.py`

#### FastAPI

В папке **fastAPI**, выполнить:

`uvicorn main:app --host=ваш_хост --port=предпочитаемый_порт --reload`

На этом этапе поднят инстанс FastAPI, он необходим для работы веб-приложения администратора.

#### Scrapy parsers

Парсеры вынесены за пределы Backend-части в целях безопасности (secure by design).

Не выходя из окружения, переходим в папку **sites** запускаем на выбор парсеры:

`scrapy crawl aeromotus` - Для запуска паука под сайт aeromotus

`scrapy crawl dronescnas` - Для запуска паука под сайт-БД dronescnas

`scrapy crawl mavikSpider` - Для запуска паука под сайт dji

`scrapy crawl metaspider ` - Для запуска Метапаука

#### Frontend

Откройте терминал в папке ***frontend***, выполните команды:

`npm install`

`npm run serve`

После этого frontend-часть этого проекта будет доступна либо на *http://localhost:8080/*, либо на *http://localhost:8081/*

## Принцип работы проекта

Была выполнена задача минимум - сделаны краулеры под основные сайты с записью в БД, либо в xlsx файл. Для решения задачи сбора данных с любого сайта был разработан прототип Метапаука.

Основой для создания прототипа составила гипотеза - данные характеристик БПЛА находятся обычно в html-тэгах `<table>, <li>, <ul>, <ol>.`

Для из нахождения необходимо составить покрывающий граф ссылок сайта, грубо говоря - карту сайта. В целях создания универсального средства, было принято решение отказаться от Sitemap в файлах robots.txt, так как не на всех сайта присутсвует данная возможность.

Парсеры scrapy собирают данные в PostgreSQL, FastAPI работает с приложением на Vue.js которое визуализирует собранные данные.

### Оценка дальности полета БПЛА

Игорь

### Screencast

Мы собрали данные с предоставленных сайтов и визуализировали их с помощью нашей системы. Если вам интересно посмотреть как это выглядит - предлагаю ознакомиться с записью ниже,

*https://disk.yandex.ru/i/oKKpxNclmC715Q*
