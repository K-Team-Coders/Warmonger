# Warmonger

*Доброго времени суток, всем кто это читает. Вашему вниманию представляется распределенная автоматизированная система сбора и обработки информации под названием "**Warmonger" (пер. англ. Милитарист)***

# Требования к эксплуатации

1) PostgreSQL => 10.0
2) Python => 3.8.5
3) Библиотеки из backend/requirements.txt (для работы парсера - также библиотеки из parser/requirements.txt)
4) Широкополосное подключение к ИТКС "Интернет"

# Установка

#### Подключение к БД

создайте файл CREDENTIALS.env в корне проекта, напишите в нем данные для подключения к БД PostgreSQL

`PORT = port `

`USER = user `

`PASSWORD = password `

`HOST = localhost \ ip `

`NAME = name`

#### Подключение TelethoneAPI

создайте файл TELETHONE.env в директории parser, напишите поля по образцу:

`TELETHONE_ID = your_id`
`TELETHONE_HASH = your_hash`

Узнать значения данных полей можно из документации Telethone - https://docs.telethon.dev/en/stable/

# Запуск приложения через Docker (в процессе)

Откройте терминал в корне проекта, пропишите команду `docker-compose up -d`

Через некоторое время можно зайти в браузер по адресу *http://localhost:8080/*

# Запуск приложения вручную

#### Backend

Откройте терминал в папке ***backend***, выполните команды:

`python -m venv venv`

`venv\Scripts\activate`

`pip install -r requirements.txt`

Вы создали виртуальное окружение и загрузили необходимые библиотеки, теперь можно запустить backend-часть этого проекта

В папке backend, выполнить

Для создания моделей django в БД:

`python manage.py makemigrations`

`python manage.py migrate`

Для запуска приложения:

`python manage.py runserver`

#### Telegram parser

Откройте терминал в папке parser

`python -m venv venv`

`venv\Scripts\activate`

`pip install -r requirements.txt`

Для корретной работы парсера необходимо сначала запустить django сервер, с выполненными миграциями в БД.

#### Frontend

Откройте терминал в папке ***frontend***, выполните команды:

`npm install`

`npm run serve`

После этого frontend-часть этого проекта будет доступна либо на http://localhost:8080/, либо на http://localhost:8081/

### Принцип работы проекта

В файле main.py, в директории parser вы можете конфигурировать собираемые источники - на вход принимается массив с ссылками на целевые телеграм-каналы или группы.
Если это необходимо, вы можете осуществлять поиск по ключевым словам - для этого нужно задать SearchQuery, методом setSearchQuery.

Ключевых слов может быть несколько, поэтому они подаются в виде массива строк. 

Далее, парсер вычленяет именнованные сущности из собранного текста, определяет координаты локаций (при их определении), и отправляет по адресу http://127.0.0.1:8000/main/addNews/.

Django принимает данные и добавляет в postgreSQL.

Если Вы обладаете сетевой инфраструктурой - наилучшим решением будет поднятие инстанса парсера на машина-сборщиках и указание адреса для добавления данных в БД. 

Добавление данных через django сделано в целях экономии времени, на полноценном проекте можно будет добавлять со стороны клиента напрямую в БД, с помощью библиотеки psycopg2.

### Выводы по работе и дальнейшие перспективы

На данный момент имеем standalone систему сбора и обработки информации, и приложения для администрирования и визуализации полученной информации. 

## API

Весь API представлен в файлах **views.py** и **urls.py** Django - приложения.

API к моделям предполагает передачу собранной инфомации от парсера в POST-запросе по адресу:

1) *http://127.0.0.1/main/addNews/*

То есть приложение можно использовать в любых проектах
